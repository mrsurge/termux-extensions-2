# Extension Proposal: Shortcut Wizard

## 1. Core Concept

The "Shortcut Wizard" is a self-contained extension that provides a graphical user interface for creating, viewing, and editing shell scripts located in the `~/.shortcuts` directory. It aims to simplify script creation by breaking down a script into its fundamental components (variables, commands, arguments) and providing a user-friendly editor to assemble them, removing the need for users to have perfect bash syntax knowledge.

## 2. User Interface (UI) Flow

### 2.1. Main View
The extension's initial view is simple, presenting the user with two primary actions, likely displayed as large buttons:
*   **New Shortcut:** Launches the Shortcut Editor to create a brand new script.
*   **Edit Shortcuts:** Opens a view listing all existing scripts, allowing a user to view or edit them.

### 2.2. Shortcut Editor View
This is the core of the wizard. It's a form composed of distinct sections and input fields that represent the building blocks of a shell script:
*   **Shebang:** An option to include the standard Termux shebang (`#!/data/data/com.termux/files/usr/bin/bash`).
*   **Environment Variables:** A section to define key-value pairs for environment variables (e.g., `MY_VAR="some_value"`).
*   **Command:** The main command to be executed. This can be:
    *   Typed manually by the user.
    *   Selected from a list of commands discovered on the system's `$PATH`.
*   **Arguments & Flags:** A section to add arguments and flags for the main command. This could include advanced logic, such as:
    *   Providing suggestions based on shell completion logic (e.g., `bash-completion`).
*   **File/Directory Inputs:** A special feature to allow an argument to be a file or directory path, selected via a **built-in file browser**.
*   **Filename:** A field to specify the name of the final script file (e.g., `my_script.sh`).

### 2.3. Edit Shortcut View
This view displays a list of all files in `~/.shortcuts`.
*   **Visual Distinction:** Scripts that were created by the wizard will be clearly marked as "editable". Non-wizard scripts will be visible but marked as read-only within the editor.
*   **Action:** Clicking an editable script will launch the **Shortcut Editor View**, pre-filled with the data from that script.

## 3. Technical Design & Data Model

### 3.1. Script Generation
When a user saves a "New" or "Edited" shortcut, the wizard will assemble the values from all the UI fields into a valid bash script and write it to `~/.shortcuts/`.

### 3.2. Metadata: The JSON "Sidecar" File
This is the key to making scripts editable.
*   **Creation:** Whenever the wizard saves a script (e.g., `my_script.sh`), it will also save a corresponding JSON file with the same name (e.g., `my_script.sh.json`) in a hidden metadata directory.
*   **Content:** This JSON file will not store the script itself, but rather the deconstructed *values* from the UI fields. For example:
    ```json
    {
      "wizard_generated": true,
      "version": "1.0",
      "shebang": true,
      "env_vars": {
        "VAR1": "value1"
      },
      "command": "ls",
      "args": [
        "-la",
        {"type": "file_path", "value": "/data/data/com.termux/files/home"}
      ]
    }
    ```
*   **Identification:** A script is considered "editable" if its corresponding `.json` sidecar file exists. We can also add a comment inside the shell script itself, like `# Generated by Shortcut Wizard`, as an extra identifier.

### 3.3. The Editing Process
When the user clicks "Edit" on a wizard-generated script:
1.  The framework finds the associated `my_script.sh.json` file.
2.  It reads and parses the JSON data.
3.  It launches the Shortcut Editor view and uses the parsed data to pre-populate every field to the exact state it was in when it was last saved.
4.  Saving simply overwrites the old `.sh` and `.sh.json` files.
